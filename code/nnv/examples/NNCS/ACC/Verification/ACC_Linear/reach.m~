% Reachability analysis for Linear ACC model
% Dung Tran: 9/30/2019



% System model
% x1 = lead_car position
% x2 = lead_car velocity
% x3 = lead_car internal state

% x4 = ego_car position
% x5 = ego_car velocity
% x6 = ego_car internal state

% lead_car dynamics
%dx(1,1)=x(2);
%dx(2,1) = x(3);
%dx(3,1) = -2 * x(3) + 2 * a_lead - mu*x(2)^2;

% ego car dynamics
%dx(4,1)= x(5); 
%dx(5,1) = x(6);
%dx(6,1) = -2 * x(6) + 2 * a_ego - mu*x(5)^2;


A = [0 1 0 0 0 0; 0 0 1 0 0 0; 0 0 -2 0 0 0; 0 0 0 0 1 0; 0 0 0 0 0 1; 0 0 0 0 0 -2];


B = transpose([0 0 2 0 0 0; 0 0 0 0 0 2]);
C = [1 0 0 0 -1 0 0; ];



a_lead = -2; 
dx(1,1)=x(2);
dx(2,1) = x(3);
dx(3,1) = -2 * x(3) + 2 * a_lead - mu*x(2)^2;
% ego car dyanmics
dx(4,1)= x(5); 
dx(5,1) = x(6);
dx(6,1) = -2 * x(6) + 2 * a_ego - mu*x(5)^2;

C = [1 0 -1 0; 0 1 0 -1; 0 0 0 1]; % feedback relative distance, relative velocity, longitudinal velocity
